{
    "edges": [
      {
        "from": "secrets-1",
        "to": "deliberation",
        "constant": true,
        "out": "API_KEY",
        "in": "API_KEY"
      },
      {
        "from": "secrets-1",
        "to": "handle-orders",
        "constant": true,
        "out": "CREATE_ORDER_URL",
        "in": "url"
      },
      {
        "from": "secrets-1",
        "to": "wait-for-printer",
        "constant": true,
        "out": "GET_ORDER_URL",
        "in": "url"
      },
      {
        "from": "secrets-1",
        "out": "_",
        "to": "no-order",
        "in": "_",
        "optional": true
      },
      {
        "from": "no-order",
        "out": "value",
        "to": "ask-user",
        "in": "_something"
      },
      {
        "from": "load-first-question",
        "out": "text",
        "to": "ask-user",
        "in": "message",
        "optional": true
      },
      {
        "from": "load-first-question",
        "out": "text",
        "to": "deliberation-template-py",
        "in": "agent",
        "optional": true
      },
      {
        "from": "ask-user",
        "out": "text",
        "to": "deliberation-template-py",
        "in": "user"
      },
      {
        "from": "load-prompt",
        "out": "text",
        "to": "deliberation-template-py",
        "in": "context",
        "optional": true
      },
      {
        "from": "deliberation-template-py",
        "out": "prompt",
        "to": "conversation-history",
        "in": "context"
      },
      {
        "from": "deliberation-template-py",
        "out": "output",
        "to": "deliberation",
        "in": "text"
      },
      {
        "from": "handle-orders",
        "out": "success",
        "to": "no-order",
        "in": "value",
        "optional": true
      },
      {
        "from": "deliberation",
        "out": "completion",
        "to": "extract-action",
        "in": "text"
      },
      {
        "from": "deliberation",
        "out": "completion",
        "to": "deliberation-template-py",
        "in": "agent"
      },
      {
        "from": "deliberation",
        "out": "completion",
        "to": "extract-order",
        "in": "text"
      },
      {
        "from": "deliberation",
        "out": "completion",
        "to": "extract-response",
        "in": "text"
      },
      {
        "from": "extract-action",
        "out": "_",
        "to": "extract-response",
        "in": "_require-action",
        "optional": true
      },
      {
        "from": "deliberation",
        "out": "completion",
        "to": "no-order",
        "in": "_trigger",
        "optional": true
      },
      {
        "from": "extract-order",
        "out": "match1",
        "to": "handle-orders",
        "in": "body"
      },
      {
        "from": "extract-action",
        "out": "groups",
        "to": "check-if-finished",
        "in": "texts"
      },
      {
        "from": "extract-action",
        "out": "groups",
        "to": "check-for-get-menu",
        "in": "texts"
      },
      {
        "from": "check-if-finished",
        "out": "result",
        "to": "handle-orders",
        "in": "_required"
      },
      {
        "from": "check-if-finished",
        "out": "result",
        "to": "no-move-found",
        "in": "value",
        "optional": true
      },
      {
        "from": "check-for-get-menu",
        "out": "result",
        "to": "call-get-menu",
        "in": "_value"
      },
      {
        "from": "call-get-menu",
        "out": "response",
        "to": "prompt-template",
        "in": "user",
        "optional": true
      },

      {
        "from": "no-move-found",
        "out": "value",
        "to": "extract-response",
        "in": "_requires-no-move"
      },
      {
        "from": "extract-response",
        "out": "match1",
        "to": "ask-user",
        "in": "message"
      },
      {
        "from": "handle-orders",
        "out": "response",
        "to": "extract-key-field",
        "in": "data"
      },
      {
        "from": "extract-key-field",
        "out": "value",
        "to": "wait-for-printer",
        "in": "key"
      },
      {
        "from": "conversation-history",
        "out": "context",
        "to": "deliberation-template-py",
        "in": "context",
        "optional": true
      }
    ],
    "nodes": [
      {
        "id": "no-order",
        "type": "not-logic"
      },
      {
        "id": "no-move-found",
        "type": "not-logic"
      },
      {
        "id": "load-first-question",
        "type": "text-asset",
        "configuration": {
          "filename": "seeds/coffee-bot/prompts/first-question.txt"
        }
      },
      {
        "id": "load-prompt",
        "type": "text-asset",
        "configuration": {
          "filename": "seeds/coffee-bot/prompts/coffee-menu-prompt.txt"
        }
      },
      {
        "id": "ask-user",
        "type": "input",
        "configuration": {
        }
      },
      {
        "id": "deliberation-template",
        "type": "prompt-template",
        "configuration": {
          "agent": "",
          "template": "{{context}}\n{{agent}}\nCustomer: {{user}}\n"
        }
      },
      {
        "id": "deliberation-template-py",
        "type": "python",
        "configuration": {
          "agent": "",
          "file": "../../../../../../labs-prototypes/append_stuff.py"
        }
      },
      {
        "id": "input-template",
        "type": "prompt-template",
        "configuration": {
          "agent": "",
          "template": "API: {{API}}\nCustomer: {{user}}\n"
        }
      },
      {
        "id": "secrets-1",
        "type": "secrets",
        "configuration": {
          "keys": [
            "API_KEY",
            "CREATE_ORDER_URL",
            "GET_ORDER_URL"
          ]
        }
      },
      {
        "id": "deliberation",
        "type": "text-completion",
        "configuration": {
          "HARM_CATEGORY_DEROGATORY": "BLOCK_MEDIUM_AND_ABOVE",
          "candidate_count": 1
        }
      },
      {
        "id": "extract-response",
        "type": "regex",
        "configuration": {
          "expression": "\"action\": \"(.*)\",\n"
        }
      },
      {
        "id": "extract-order",
        "type": "regex",
        "configuration": {
          "pattern": "\"currentOrder\":(.*),\n"
        }
      },
      {
        "id": "extract-action",
        "type": "regex",
        "configuration": {
          "pattern": "\"action\": \"(.*)\",\n"
        }
      },
      {
        "id": "extract-key-field",
        "type": "get-field",
        "configuration": {
          "field": "key"
        }
      },
      {
        "id": "handle-orders",
        "type": "api-call",
        "configuration": {
          "method": "POST",
          "headers": {
            "Content-Type": "application/json"
          }
        }
      },
      {
        "id": "call-get-menu",
        "type": "api-call",
        "configuration": {
          "method": "POST",
          "headers": {
            "Content-Type": "application/json"
          }
        }
      },
      {
        "id": "check-if-finished",
        "type": "contains-str",
        "configuration": {
          "pattern": "finishOrder"
        }
      },
      {
        "id": "check-for-get-menu",
        "type": "contains-str",
        "configuration": {
          "pattern": "checkMenu"
        }
      },
      {
        "id": "wait-for-printer",
        "type": "api-call",
        "configuration": {
          "method": "GET",
          "headers": {
            "Content-Type": "application/json"
          },
          "expected_value": null,
          "success_required": true,
          "num_retries": 5,
          "retry_delay_ms": 5000
        }
      },
      {
        "id": "conversation-history",
        "type": "local-memory"
      }
    ],
    "kits": [
      {
        "url": "npm:@google-labs/coffee-bot"
      },
      {
        "url": "npm:@google-labs/llm-starter"
      }
    ]
  }
  